@using System.Text.Json;
@model WorkFlowResponseModel
<div>
    <table class="tableborder">
         <tr>
            <td style="color:blue; background-color:blue; color:white;">          
                From Activity
            </td>
            <td style="color:blue; background-color:blue; color:white;">
                To  Activity
            </td>
            <td style="color:blue; background-color:blue; color:white;">
                Status
            </td>
        </tr>          
        @*<tr>
            <td>
                @Model.Processdefinition.InitialActivity.Name
            </td>
            <td>     
                @{
                string activityName = Model.Processdefinition.InitialActivity.Name;
                string nextActivityName = "";
                bool isFinalActivity = false; 
                @foreach(var data in Model.Processdefinition.Transitions.Where(d => d.From.Name == @Model.Processdefinition.InitialActivity.Name))
                { 
                    nextActivityName = data.To.Name;
                    isFinalActivity = false;  
                    @data.To.Name                    
                } 
                }
            </td>
            <td>                                                            
                @if(Model.CurrentActivityName == activityName)
                {
                <span style="color:blue;font-weight:bold;">IN PROGRESS</span> 
                }                
            </td> 
        </tr> *@
        @*@while(!isFinalActivity)
        {
            @foreach (var data in Model.Processdefinition.Transitions.Where(d => d.From.Name == nextActivityName))
            {
                activityName = data.From.Name;
                nextActivityName = data.To.Name;
                isFinalActivity = data.To.IsFinal;
                <tr>
                    <td>
                        @data.From.Name
                    </td>
                    <td>
                        @data.To.Name
                    </td>
                    <td>                                                            
                        @if(Model.CurrentActivityName == activityName)
                        {
                        <span style="color:blue;font-weight:bold;">IN PROGRESS</span> 
                        }                
                    </td> 
                </tr>        
            }
        }*@
         @{                
            var wfJsonModel = JsonSerializer.Serialize(Model);  
        }    
        @foreach(var data in Model.ListActivityModel)
        {
            <tr>
                <td>                         
                    @if (Model.CurrentActivityName == @data.ActivityName && !@data.IsFinal)
                    {
                        <a class="navlinkcolor" asp-area="" asp-controller="CPROChain" asp-action="UpdateActivity" asp-route-jsonString=@wfJsonModel>@data.ActivityName</a>                            
                    }
                    else
                    {
                        <span>@data.ActivityName</span>
                    }
                </td>
                <td>                                                            
                    @if(Model.CurrentActivityName == @data.ActivityName && !@data.IsFinal)
                    {
                        <span style="color:blue;font-weight:bold;">IN PROGRESS</span>
                    }
                    else if(Model.CurrentActivityName == @data.ActivityName && @data.IsFinal)
                    {
                        <span style="color:red;font-weight:bold;">CLOSED</span> 
                    }
                </td>  
        </tr>                    
        }      
    </table>
</div>